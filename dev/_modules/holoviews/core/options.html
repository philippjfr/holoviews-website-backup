



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>holoviews.core.options &mdash; HoloViews</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/bootstrap.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/codehilite.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/rtd_bootstrap.css" type="text/css" />
  
        <link rel="author" title="About these documents"
              href="../../../about.html"/>
    <link rel="top" title="HoloViews" href="../../../index.html"/>
        <link rel="up" title="holoviews.core" href="../core.html"/>
    <script type="text/javascript" src='../../../_static/jquery.js'></script>
    <script type="text/javascript" src='../../../_static/underscore.js'></script>
    <script type="text/javascript" src='../../../_static/doctools.js'></script>
    <script type="text/javascript" src='../../../_static/require.js'></script>
    <script type="text/javascript" src='../../../_static/bootstrap.js'></script>
    <script type="text/javascript" src='../../../_static/custom.js'></script>
    <script type="text/javascript" src='../../../_static/js/theme.js'></script>



  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">

        
          <img src="../../../_static/holoviews_logo.png" class="logo" />
        

        <a href="../../../index.html" class="fa"> HoloViews</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Tutorials/index.html">Tutorials</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Examples/index.html">Examples</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Reference_Manual/index.html">Reference Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Reference_Manual/holoviews.core.html">core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Reference_Manual/holoviews.element.html">element</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Reference_Manual/holoviews.interface.html">interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Reference_Manual/holoviews.ipython.html">ipython</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Reference_Manual/holoviews.operation.html">operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Reference_Manual/holoviews.plotting.html">plotting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../FAQ.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/ioam/holoviews">Github source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../about.html">About</a><ul class="simple">
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">HoloViews</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="main">
            
  <h1>Source code for holoviews.core.options</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Options and OptionTrees allow different classes of options</span>
<span class="sd">(e.g. matplotlib-specific styles and plot specific parameters) to be</span>
<span class="sd">defined separately from the core data structures and away from</span>
<span class="sd">visualization specific code.</span>

<span class="sd">There are three classes that form the options system:</span>

<span class="sd">Cycle:</span>

<span class="sd">   Used to define infinite cycles over a finite set of elements, using</span>
<span class="sd">   either an explicit list or some pre-defined collection (e.g from</span>
<span class="sd">   matplotlib rcParams). For instance, a Cycle object can be used loop</span>
<span class="sd">   a set of display colors for multiple curves on a single axis.</span>

<span class="sd">Options:</span>

<span class="sd">   Containers of arbitrary keyword values, including optional keyword</span>
<span class="sd">   validation, support for Cycle objects and inheritance.</span>

<span class="sd">OptionTree:</span>

<span class="sd">   A subclass of AttrTree that is used to define the inheritance</span>
<span class="sd">   relationships between a collection of Options objects. Each node</span>
<span class="sd">   of the tree supports a group of Options objects and the leaf nodes</span>
<span class="sd">   inherit their keyword values from parent nodes up to the root.</span>

<span class="sd">Store:</span>

<span class="sd">   A singleton class that stores all global and custom options and</span>
<span class="sd">   links HoloViews objects, the chosen plotting backend and the IPython</span>
<span class="sd">   extension together.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">param</span>
<span class="kn">from</span> <span class="nn">.tree</span> <span class="kn">import</span> <span class="n">AttrTree</span>
<span class="kn">from</span> <span class="nn">.util</span> <span class="kn">import</span> <span class="n">sanitize_identifier</span>
<span class="kn">from</span> <span class="nn">.pprint</span> <span class="kn">import</span> <span class="n">InfoPrinter</span>

<div class="viewcode-block" id="OptionError"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.OptionError">[docs]</a><span class="k">class</span> <span class="nc">OptionError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Custom exception raised when there is an attempt to apply invalid</span>
<span class="sd">    options. Stores the necessary information to construct a more</span>
<span class="sd">    readable message for the user if caught and processed</span>
<span class="sd">    appropriately.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">invalid_keyword</span><span class="p">,</span> <span class="n">allowed_keywords</span><span class="p">,</span>
                 <span class="n">group_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">OptionError</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">invalid_keyword</span><span class="p">,</span>
                                                       <span class="n">allowed_keywords</span><span class="p">,</span>
                                                       <span class="n">group_name</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invalid_keyword</span> <span class="o">=</span> <span class="n">invalid_keyword</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_keywords</span> <span class="o">=</span> <span class="n">allowed_keywords</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_name</span> <span class="o">=</span><span class="n">group_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>


    <span class="k">def</span> <span class="nf">message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">invalid_keyword</span><span class="p">,</span> <span class="n">allowed_keywords</span><span class="p">,</span> <span class="n">group_name</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Invalid option </span><span class="si">%s</span><span class="s">, valid options are: </span><span class="si">%s</span><span class="s">&quot;</span>
               <span class="o">%</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">invalid_keyword</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">allowed_keywords</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">and</span> <span class="n">group_name</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Invalid key for group </span><span class="si">%r</span><span class="s"> on path </span><span class="si">%r</span><span class="s">;</span><span class="se">\n</span><span class="s">&quot;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="n">group_name</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span> <span class="o">+</span> <span class="n">msg</span>
        <span class="k">return</span> <span class="n">msg</span>

</div>
<div class="viewcode-block" id="Cycle"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Cycle">[docs]</a><span class="k">class</span> <span class="nc">Cycle</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">Parameterized</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A simple container class that specifies cyclic options. A typical</span>
<span class="sd">    example would be to cycle the curve colors in an Overlay composed</span>
<span class="sd">    of an arbitrary number of curves. The values may be supplied as</span>
<span class="sd">    an explicit list or a key to look up in the default cycles</span>
<span class="sd">    attribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s">&#39;default_colors&#39;</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">       The key in the default_cycles dictionary used to specify the</span>
<span class="s">       color cycle if values is not supplied. &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">values</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">[],</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">       The values the cycle will iterate over.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">default_cycles</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;default_colors&#39;</span><span class="p">:</span> <span class="p">[]}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Cycle</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_values</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="n">num</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">_get_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_cycles</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Supply either a key or explicit values.&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">values</span> <span class="k">if</span> <span class="n">values</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_param_values</span><span class="p">(),</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">(values=</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span>
                                  <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>


</div>
<span class="k">def</span> <span class="nf">grayscale</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>


<div class="viewcode-block" id="Palette"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Palette">[docs]</a><span class="k">class</span> <span class="nc">Palette</span><span class="p">(</span><span class="n">Cycle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Palettes allow easy specifying a discrete sampling</span>
<span class="sd">    of an existing colormap. Palettes may be supplied a key</span>
<span class="sd">    to look up a function function in the colormap class</span>
<span class="sd">    attribute. The function should accept a float scalar</span>
<span class="sd">    in the specified range and return a RGB(A) tuple.</span>
<span class="sd">    The number of samples may also be specified as a</span>
<span class="sd">    parameter.</span>

<span class="sd">    The range and samples may conveniently be overridden</span>
<span class="sd">    with the __getitem__ method.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s">&#39;grayscale&#39;</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">       Palettes look up the Palette values based on some key.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="nb">range</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">NumericTuple</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">        The range from which the Palette values are sampled.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">samples</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">        The number of samples in the given range to supply to</span>
<span class="s">        the sample_fn.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">sample_fn</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">Callable</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">        The function to generate the samples, by default linear.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">reverse</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">Boolean</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">        Whether to reverse the palette.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="c"># A list of available colormaps</span>
    <span class="n">colormaps</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;grayscale&#39;</span><span class="p">:</span> <span class="n">grayscale</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Cycle</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_values</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a convenient interface to override the</span>
<span class="sd">        range and samples parameters of the Cycle.</span>
<span class="sd">        Supplying a slice step or index overrides the</span>
<span class="sd">        number of samples. Unsupplied slice values will be</span>
<span class="sd">        inherited.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">),</span> <span class="n">step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">slc</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">slc</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">slc</span><span class="o">.</span><span class="n">start</span>
            <span class="k">if</span> <span class="n">slc</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="n">slc</span><span class="o">.</span><span class="n">stop</span>
            <span class="k">if</span> <span class="n">slc</span><span class="o">.</span><span class="n">step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">step</span> <span class="o">=</span> <span class="n">slc</span><span class="o">.</span><span class="n">step</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">step</span> <span class="o">=</span> <span class="n">slc</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">),</span> <span class="n">samples</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_get_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">]</span>
        <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">),</span> <span class="n">steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmap</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_fn</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">steps</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">samples</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span> <span class="k">else</span> <span class="n">samples</span>


</div>
<div class="viewcode-block" id="Options"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Options">[docs]</a><span class="k">class</span> <span class="nc">Options</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">Parameterized</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An Options object holds a collection of keyword options. In</span>
<span class="sd">    addition, Options support (optional) keyword validation as well as</span>
<span class="sd">    infinite indexing over the set of supplied cyclic values.</span>

<span class="sd">    Options support inheritance of setting values via the __call__</span>
<span class="sd">    method. By calling an Options object with additional keywords, you</span>
<span class="sd">    can create a new Options object inheriting the parent options.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">allowed_keywords</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">allow_None</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">       Optional list of strings corresponding to the allowed keywords.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">key</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">allow_None</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">       Optional specification of the options key name. For instance,</span>
<span class="s">       key could be &#39;plot&#39; or &#39;style&#39;.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">merge_keywords</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">Boolean</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">       Whether to merge with the existing keywords if the corresponding</span>
<span class="s">       node already exists&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">skip_invalid</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">Boolean</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">       Whether all Options instances should skip invalid keywords or</span>
<span class="s">       raise and exception. May only be specified at the class level.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">warn_on_skip</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">Boolean</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">       Whether all Options instances should generate warnings when</span>
<span class="s">       skipping over invalid keywords or not. May only be specified at</span>
<span class="s">       the class level.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">allowed_keywords</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">merge_keywords</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">invalid_kws</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">kwarg</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">allowed_keywords</span> <span class="ow">and</span> <span class="n">kwarg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_keywords</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_invalid</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">kwarg</span><span class="p">)</span>
                    <span class="n">invalid_kws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwarg</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">OptionError</span><span class="p">(</span><span class="n">kwarg</span><span class="p">,</span> <span class="n">allowed_keywords</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">invalid_kws</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">warn_on_skip</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;Invalid options </span><span class="si">%s</span><span class="s">, valid options are: </span><span class="si">%s</span><span class="s">&quot;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">invalid_kws</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">allowed_keywords</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_options</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">allowed_keywords</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">allowed_keywords</span><span class="p">)</span> <span class="k">if</span> <span class="n">allowed_keywords</span> <span class="k">else</span> <span class="bp">None</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Options</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">allowed_keywords</span><span class="o">=</span><span class="n">allowed_keywords</span><span class="p">,</span>
                                      <span class="n">merge_keywords</span><span class="o">=</span><span class="n">merge_keywords</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">allowed_keywords</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new Options object that inherits the parent options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">allowed_keywords</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">allowed_keywords</span> <span class="k">if</span> <span class="n">allowed_keywords</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">allowed_keywords</span>
        <span class="n">inherited_style</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">allowed_keywords</span><span class="o">=</span><span class="n">allowed_keywords</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">inherited_style</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_expand_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Expand out Cycle objects into multiple sets of keyword values.</span>

<span class="sd">        To elaborate, the full Cartesian product over the supplied</span>
<span class="sd">        Cycle objects is expanded into a list, allowing infinite,</span>
<span class="sd">        cyclic indexing in the __getitem__ method.&quot;&quot;&quot;</span>
        <span class="n">filter_static</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Cycle</span><span class="p">))</span>
        <span class="n">filter_cycles</span> <span class="o">=</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Cycle</span><span class="p">)]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">filter_cycles</span><span class="p">:</span> <span class="k">return</span> <span class="p">[</span><span class="n">kwargs</span><span class="p">]</span>

        <span class="n">filter_names</span><span class="p">,</span> <span class="n">filter_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">filter_cycles</span><span class="p">))</span>

        <span class="n">cyclic_tuples</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">filter_values</span><span class="p">]))</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">filter_names</span><span class="p">,</span> <span class="n">tps</span><span class="p">),</span> <span class="o">**</span><span class="n">filter_static</span><span class="p">)</span> <span class="k">for</span> <span class="n">tps</span> <span class="ow">in</span> <span class="n">cyclic_tuples</span><span class="p">]</span>


<div class="viewcode-block" id="Options.keys"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Options.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;The keyword names across the supplied options.&quot;</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

</div>
<div class="viewcode-block" id="Options.max_cycles"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Options.max_cycles">[docs]</a>    <span class="k">def</span> <span class="nf">max_cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Truncates all contained Cycle objects to a maximum number</span>
<span class="sd">        of Cycles and returns a new Options object with the</span>
<span class="sd">        truncated or resampled Cycles.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">kw</span><span class="p">:</span> <span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="n">num</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">Cycle</span><span class="p">)</span> <span class="k">else</span> <span class="n">arg</span><span class="p">)</span>
                  <span class="k">for</span> <span class="n">kw</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

</div>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Infinite cyclic indexing of options over the integers,</span>
<span class="sd">        looping over the set of defined Cycle objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="n">index</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">)])</span>


    <span class="nd">@property</span>
<div class="viewcode-block" id="Options.options"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Options.options">[docs]</a>    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Access of the options keywords when no cycles are defined.&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;The options property may only be used with non-cyclic Options.&quot;</span><span class="p">)</span>

</div>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">kws</span> <span class="o">=</span> <span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">=</span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">(</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span>  <span class="n">kws</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


</div>
<div class="viewcode-block" id="OptionTree"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.OptionTree">[docs]</a><span class="k">class</span> <span class="nc">OptionTree</span><span class="p">(</span><span class="n">AttrTree</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A subclass of AttrTree that is used to define the inheritance</span>
<span class="sd">    relationships between a collection of Options objects. Each node</span>
<span class="sd">    of the tree supports a group of Options objects and the leaf nodes</span>
<span class="sd">    inherit their keyword values from parent nodes up to the root.</span>

<span class="sd">    Supports the ability to search the tree for the closest valid path</span>
<span class="sd">    using the find method, or compute the appropriate Options value</span>
<span class="sd">    given an object and a mode. For a given node of the tree, the</span>
<span class="sd">    options method computes a Options object containing the result of</span>
<span class="sd">    inheritance for a given group up to the root of the tree.</span>

<span class="sd">    When constructing an OptionTree, you can specify the option groups</span>
<span class="sd">    as a list (i.e empty initial option groups at the root) or as a</span>
<span class="sd">    dictionary (e.g groups={&#39;style&#39;:Option()}). You can also</span>
<span class="sd">    initialize the OptionTree with the options argument together with</span>
<span class="sd">    the **kwargs - see StoreOptions.merge_options for more information</span>
<span class="sd">    on the options specification syntax.</span>

<span class="sd">    You can use the string specifier &#39;.&#39; to refer to the root node in</span>
<span class="sd">    the options specification. This acts as an alternative was of</span>
<span class="sd">    specifying the options groups of the current node. Note that this</span>
<span class="sd">    approach method may only be used with the group lists format.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">identifier</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">groups</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">groups</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Please supply groups list or dictionary&#39;</span><span class="p">)</span>
        <span class="n">_groups</span> <span class="o">=</span> <span class="p">{</span><span class="n">g</span><span class="p">:</span><span class="n">Options</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">}</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">groups</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;groups&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_groups</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;_instantiated&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">AttrTree</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;_instantiated&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">options</span> <span class="o">=</span> <span class="n">StoreOptions</span><span class="o">.</span><span class="n">merge_options</span><span class="p">(</span><span class="n">_groups</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">options</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">root_groups</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">root_groups</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;groups&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">g</span><span class="p">:</span><span class="n">Options</span><span class="p">(</span><span class="o">**</span><span class="n">root_groups</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">g</span><span class="p">,{}))</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">_groups</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
        <span class="k">elif</span> <span class="n">root_groups</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Group specification as a dictionary only supported if &quot;</span>
                            <span class="s">&quot;the root node &#39;.&#39; syntax not used in the options.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
            <span class="n">StoreOptions</span><span class="o">.</span><span class="n">apply_customizations</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_merge_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">group_name</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a merged Options object for the given group</span>
<span class="sd">        name from the existing Options on the node and the</span>
<span class="sd">        new Options which are passed in.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">override_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">allowed_kws</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">allowed_keywords</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">options</span><span class="o">.</span><span class="n">allowed_keywords</span>
        <span class="n">old_allowed</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">identifier</span><span class="p">][</span><span class="n">group_name</span><span class="p">]</span><span class="o">.</span><span class="n">allowed_keywords</span> <span class="k">if</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="n">old_allowed</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">old_allowed</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">old_allowed</span>
        <span class="n">override_kwargs</span><span class="p">[</span><span class="s">&#39;allowed_keywords&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">allowed_kws</span> <span class="o">+</span> <span class="n">old_allowed</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">group_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s">&quot;Group </span><span class="si">%s</span><span class="s"> not defined on SettingTree&quot;</span> <span class="o">%</span> <span class="n">group_name</span><span class="p">)</span>

        <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="k">if</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="k">else</span> <span class="bp">self</span>
        <span class="n">group_options</span> <span class="o">=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group_name</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">group_options</span><span class="p">(</span><span class="o">**</span><span class="n">override_kwargs</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">merge_keywords</span> <span class="k">else</span> <span class="n">Options</span><span class="p">(</span><span class="n">group_name</span><span class="p">,</span> <span class="o">**</span><span class="n">override_kwargs</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">OptionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">OptionError</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">invalid_keyword</span><span class="p">,</span>
                              <span class="n">e</span><span class="o">.</span><span class="n">allowed_keywords</span><span class="p">,</span>
                              <span class="n">group_name</span><span class="o">=</span><span class="n">group_name</span><span class="p">,</span>
                              <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">OptionTree</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows creating sub OptionTree instances using attribute</span>
<span class="sd">        access, inheriting the group options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">AttrTree</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__getattr__</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>

        <span class="k">if</span> <span class="n">identifier</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">):</span>   <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">identifier</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixed</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>           <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fixed_error</span> <span class="o">%</span> <span class="n">identifier</span><span class="p">)</span>

        <span class="n">valid_id</span> <span class="o">=</span> <span class="n">sanitize_identifier</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">escape</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">valid_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">valid_id</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">identifier</span> <span class="o">=</span> <span class="n">sanitize_identifier</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">escape</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">new_groups</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">group_items</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Options</span><span class="p">)</span> <span class="ow">and</span> <span class="n">val</span><span class="o">.</span><span class="n">key</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Options object needs to have a group name specified.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Options</span><span class="p">):</span>
            <span class="n">group_items</span> <span class="o">=</span> <span class="p">{</span><span class="n">val</span><span class="o">.</span><span class="n">key</span><span class="p">:</span> <span class="n">val</span><span class="p">}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">OptionTree</span><span class="p">):</span>
            <span class="n">group_items</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">groups</span>

        <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="k">if</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="k">else</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">group_name</span> <span class="ow">in</span> <span class="n">current_node</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">group_items</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">group_name</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
                <span class="n">new_groups</span><span class="p">[</span><span class="n">group_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_merge_options</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">group_name</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_groups</span><span class="p">[</span><span class="n">group_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group_name</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">new_groups</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="k">else</span> <span class="bp">None</span>
            <span class="n">new_node</span> <span class="o">=</span> <span class="n">OptionTree</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">new_groups</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;OptionTree only accepts a dictionary of Options.&#39;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">OptionTree</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">new_node</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">OptionTree</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">subtree</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">subtree</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span> <span class="n">subtree</span><span class="p">)</span>


<div class="viewcode-block" id="OptionTree.find"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.OptionTree.find">[docs]</a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;node&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the closest node or path to an the arbitrary path that is</span>
<span class="sd">        supplied down the tree from the given node. The mode argument</span>
<span class="sd">        may be either &#39;node&#39; or &#39;path&#39; which determines the return</span>
<span class="sd">        type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">escaped_child</span> <span class="o">=</span> <span class="n">sanitize_identifier</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">escape</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">matching_children</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">children</span>
                                 <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="ow">or</span> <span class="n">escaped_child</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">c</span><span class="p">)]</span>
            <span class="n">matching_children</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">matching_children</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">matching_children</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="n">matching_children</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">return</span> <span class="n">item</span> <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s">&#39;node&#39;</span> <span class="k">else</span> <span class="n">item</span><span class="o">.</span><span class="n">path</span>

</div>
<div class="viewcode-block" id="OptionTree.closest"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.OptionTree.closest">[docs]</a>    <span class="k">def</span> <span class="nf">closest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">group</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method is designed to be called from the root of the</span>
<span class="sd">        tree. Given any LabelledData object, this method will return</span>
<span class="sd">        the most appropriate Options object, including inheritance.</span>

<span class="sd">        In addition, closest supports custom options by checking the</span>
<span class="sd">        object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">components</span> <span class="o">=</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">sanitize_identifier</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">group</span><span class="p">),</span>
                      <span class="n">sanitize_identifier</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">components</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>


</div>
<div class="viewcode-block" id="OptionTree.options"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.OptionTree.options">[docs]</a>    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Using inheritance up to the root, get the complete Options</span>
<span class="sd">        object for the given node and the specified group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">target</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Store</span><span class="o">.</span><span class="n">options</span><span class="p">()):</span>
            <span class="n">root_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span>
            <span class="n">replacement</span> <span class="o">=</span> <span class="n">root_name</span> <span class="o">+</span> <span class="p">(</span><span class="s">&#39;&#39;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">root_name</span><span class="p">)</span> <span class="k">else</span> <span class="s">&#39;.&#39;</span><span class="p">)</span>
            <span class="n">option_key</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">replacement</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">Store</span><span class="o">.</span><span class="n">options</span><span class="p">()</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">option_key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Store</span><span class="o">.</span><span class="n">options</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">match</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Options</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">Options</span><span class="p">(</span><span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">group</span><span class="p">,</span><span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">kwargs</span><span class="p">,</span>
                              <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">kwargs</span><span class="p">))</span>
</div>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evalable representation of the OptionTree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;groups&#39;</span><span class="p">]</span>
        <span class="c"># Tab and group entry separators</span>
        <span class="n">tab</span><span class="p">,</span> <span class="n">gsep</span> <span class="o">=</span> <span class="s">&#39;   &#39;</span><span class="p">,</span> <span class="s">&#39;,</span><span class="se">\n\n</span><span class="s">&#39;</span>
        <span class="c"># Entry seperator and group specifications</span>
        <span class="n">esep</span><span class="p">,</span> <span class="n">gspecs</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;,</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">+</span><span class="p">(</span><span class="n">tab</span><span class="o">*</span><span class="mi">2</span><span class="p">)),</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">especs</span><span class="p">,</span> <span class="n">accumulator</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">groups</span><span class="p">[</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">!=</span> <span class="p">{}:</span>
                <span class="n">accumulator</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="n">groups</span><span class="p">[</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">kwargs</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">kwargs</span>
                <span class="n">accumulator</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">kwargs</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">kws</span><span class="p">)</span> <span class="ow">in</span> <span class="n">accumulator</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">group</span><span class="o">==</span><span class="s">&#39;norm&#39;</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">False</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;axiswise&#39;</span><span class="p">,</span><span class="s">&#39;framewise&#39;</span><span class="p">]):</span>
                    <span class="k">continue</span>
                <span class="k">elif</span> <span class="n">kws</span><span class="p">:</span>
                    <span class="n">especs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">kws</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">especs</span><span class="p">:</span>
                <span class="n">format_kws</span> <span class="o">=</span> <span class="p">[(</span><span class="n">t</span><span class="p">,</span><span class="s">&#39;dict(</span><span class="si">%s</span><span class="s">)&#39;</span>
                               <span class="o">%</span> <span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">kws</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>
                              <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">kws</span> <span class="ow">in</span> <span class="n">especs</span><span class="p">]</span>
                <span class="n">ljust</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="n">format_kws</span><span class="p">)</span>
                <span class="n">sep</span> <span class="o">=</span> <span class="p">(</span><span class="n">tab</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">format_kws</span><span class="p">)</span> <span class="o">&gt;</span><span class="mi">1</span> <span class="k">else</span> <span class="s">&#39;&#39;</span>
                <span class="n">entries</span> <span class="o">=</span> <span class="n">sep</span> <span class="o">+</span> <span class="n">esep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">sep</span><span class="o">+</span><span class="s">&#39;</span><span class="si">%r</span><span class="s"> : </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">ljust</span><span class="p">),</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">format_kws</span><span class="p">])</span>
                <span class="n">gspecs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&#39;</span><span class="si">%s%s</span><span class="s">={</span><span class="se">\n</span><span class="si">%s</span><span class="s">}&#39;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">format_kws</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="k">else</span> <span class="s">&#39;</span><span class="si">%s%s</span><span class="s">={</span><span class="si">%s</span><span class="s">}&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">tab</span><span class="p">,</span><span class="n">group</span><span class="p">,</span> <span class="n">entries</span><span class="p">))</span>

        <span class="k">return</span> <span class="s">&#39;OptionTree(groups=</span><span class="si">%s</span><span class="s">,</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">gsep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gspecs</span><span class="p">))</span>


</div>
<div class="viewcode-block" id="Compositor"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Compositor">[docs]</a><span class="k">class</span> <span class="nc">Compositor</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">Parameterized</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Compositor is a way of specifying an operation to be automatically</span>
<span class="sd">    applied to Overlays that match a specified pattern upon display.</span>

<span class="sd">    Any ElementOperation that takes an Overlay as input may be used to</span>
<span class="sd">    define a compositor.</span>

<span class="sd">    For instance, a compositor may be defined to automatically display</span>
<span class="sd">    three overlaid monochrome matrices as an RGB image as long as the</span>
<span class="sd">    values names of those matrices match &#39;R&#39;, &#39;G&#39; and &#39;B&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mode</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">ObjectSelector</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s">&#39;data&#39;</span><span class="p">,</span>
                                <span class="n">objects</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;display&#39;</span><span class="p">],</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">      The mode of the Compositor object which may be either &#39;data&#39; or</span>
<span class="s">      &#39;display&#39;.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">operation</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">       The ElementOperation to apply when collapsing overlays.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">pattern</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">       The overlay pattern to be processed. An overlay pattern is a</span>
<span class="s">       sequence of elements specified by dotted paths separated by * .</span>

<span class="s">       For instance the following pattern specifies three overlayed</span>
<span class="s">       matrices with values of &#39;RedChannel&#39;, &#39;GreenChannel&#39; and</span>
<span class="s">       &#39;BlueChannel&#39; respectively:</span>

<span class="s">      &#39;Image.RedChannel * Image.GreenChannel * Image.BlueChannel.</span>

<span class="s">      This pattern specification could then be associated with the RGB</span>
<span class="s">      operation that returns a single RGB matrix for display.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">group</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">       The group identifier for the output of this particular compositor&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">kwargs</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">       Optional set of parameters to pass to the operation.&quot;&quot;&quot;</span><span class="p">)</span>


    <span class="n">operations</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># The operations that can be used to define compositors.</span>
    <span class="n">definitions</span> <span class="o">=</span> <span class="p">[]</span> <span class="c"># The set of all the compositor instances</span>


    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Compositor.strongest_match"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Compositor.strongest_match">[docs]</a>    <span class="k">def</span> <span class="nf">strongest_match</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">overlay</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the single strongest matching compositor operation</span>
<span class="sd">        given an overlay. If no matches are found, None is returned.</span>

<span class="sd">        The best match is defined as the compositor operation with the</span>
<span class="sd">        highest match value as returned by the match_level method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">match_strength</span> <span class="o">=</span> <span class="p">[(</span><span class="n">op</span><span class="o">.</span><span class="n">match_level</span><span class="p">(</span><span class="n">overlay</span><span class="p">),</span> <span class="n">op</span><span class="p">)</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">definitions</span>
                          <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="n">mode</span><span class="p">]</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="p">[(</span><span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">op</span><span class="p">,</span> <span class="n">match</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="p">(</span><span class="n">match</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span> <span class="ow">in</span> <span class="n">match_strength</span> <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">matches</span> <span class="o">==</span> <span class="p">[]:</span> <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>             <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">matches</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Compositor.collapse_element"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Compositor.collapse_element">[docs]</a>    <span class="k">def</span> <span class="nf">collapse_element</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">overlay</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ranges</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;data&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds any applicable compositor and applies it.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.overlay</span> <span class="kn">import</span> <span class="n">Overlay</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">strongest_match</span><span class="p">(</span><span class="n">overlay</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">overlay</span>
        <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">applicable_op</span><span class="p">,</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">))</span> <span class="o">=</span> <span class="n">match</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">overlay</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="n">sliced</span> <span class="o">=</span> <span class="n">Overlay</span><span class="o">.</span><span class="n">from_values</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">])</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">applicable_op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">sliced</span><span class="p">,</span> <span class="n">ranges</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">applicable_op</span><span class="o">.</span><span class="n">group</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">Overlay</span><span class="o">.</span><span class="n">from_values</span><span class="p">(</span><span class="n">values</span><span class="p">[:</span><span class="n">start</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="n">result</span><span class="p">]</span><span class="o">+</span><span class="n">values</span><span class="p">[</span><span class="n">stop</span><span class="p">:])</span>
        <span class="n">output</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">overlay</span><span class="o">.</span><span class="n">id</span>
        <span class="k">return</span> <span class="n">output</span>

</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Compositor.collapse"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Compositor.collapse">[docs]</a>    <span class="k">def</span> <span class="nf">collapse</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">holomap</span><span class="p">,</span> <span class="n">ranges</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;data&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a map of Overlays, apply all applicable compositors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># No potential compositors</span>
        <span class="k">if</span> <span class="n">cls</span><span class="o">.</span><span class="n">definitions</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="k">return</span> <span class="n">holomap</span>

        <span class="c"># Apply compositors</span>
        <span class="n">clone</span> <span class="o">=</span> <span class="n">holomap</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">shared_data</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ranges</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">holomap</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">if</span> <span class="n">ranges</span> <span class="k">else</span> <span class="n">holomap</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">overlay</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">clone</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">collapse_element</span><span class="p">(</span><span class="n">overlay</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">ranges</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">clone</span>
</div>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">compositor</span><span class="p">):</span>
        <span class="n">defined_groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">op</span><span class="o">.</span><span class="n">group</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">definitions</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">compositor</span><span class="o">.</span><span class="n">group</span> <span class="ow">in</span> <span class="n">defined_groups</span><span class="p">:</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">definitions</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">defined_groups</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">compositor</span><span class="o">.</span><span class="n">group</span><span class="p">))</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">definitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compositor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">compositor</span><span class="o">.</span><span class="n">operation</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">operations</span><span class="p">:</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compositor</span><span class="o">.</span><span class="n">operation</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pattern_spec</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">pattern</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;*&#39;</span><span class="p">):</span>
            <span class="n">path_tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pattern_spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path_tuple</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">path_tuple</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path_tuple</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">l</span><span class="o">==</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s">&quot;Mismatched labels not allowed in compositor patterns&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Compositor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
                                         <span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">,</span>
                                         <span class="n">operation</span><span class="o">=</span><span class="n">operation</span><span class="p">,</span>
                                         <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
                                         <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="nd">@property</span>
<div class="viewcode-block" id="Compositor.output_type"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Compositor.output_type">[docs]</a>    <span class="k">def</span> <span class="nf">output_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the operation output_type unless explicitly overridden</span>
<span class="sd">        in the kwargs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s">&#39;output_type&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;output_type&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="o">.</span><span class="n">output_type</span>

</div>
    <span class="k">def</span> <span class="nf">_slice_match_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overlay_items</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the match strength for a list of overlay items that must</span>
<span class="sd">        be exactly the same length as the pattern specification.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">level</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">spec</span><span class="p">,</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pattern_spec</span><span class="p">,</span> <span class="n">overlay_items</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">spec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="n">el</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>
            <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>      <span class="c"># Types match</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="k">continue</span>

            <span class="n">group</span> <span class="o">=</span> <span class="p">[</span><span class="n">el</span><span class="o">.</span><span class="n">group</span><span class="p">,</span> <span class="n">sanitize_identifier</span><span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">group</span><span class="p">,</span> <span class="n">escape</span><span class="o">=</span><span class="bp">False</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">spec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span> <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c"># Values match</span>
            <span class="k">else</span><span class="p">:</span>                     <span class="k">return</span> <span class="bp">None</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">group</span> <span class="o">=</span> <span class="p">[</span><span class="n">el</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">sanitize_identifier</span><span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">escape</span><span class="o">=</span><span class="bp">False</span><span class="p">)]</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="n">group</span><span class="p">):</span>
                    <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c"># Labels match</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">level</span>


<div class="viewcode-block" id="Compositor.match_level"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Compositor.match_level">[docs]</a>    <span class="k">def</span> <span class="nf">match_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overlay</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given an overlay, return the match level and applicable slice</span>
<span class="sd">        of the overall overlay. The level an integer if there is a</span>
<span class="sd">        match or None if there is no match.</span>

<span class="sd">        The level integer is the number of matching components. Higher</span>
<span class="sd">        values indicate a stronger match.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">slice_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pattern_spec</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">slice_width</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">overlay</span><span class="p">):</span> <span class="k">return</span> <span class="bp">None</span>

        <span class="c"># Check all the possible slices and return the best matching one</span>
        <span class="n">best_lvl</span><span class="p">,</span> <span class="n">match_slice</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">overlay</span><span class="p">)</span><span class="o">-</span><span class="n">slice_width</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">overlay_slice</span> <span class="o">=</span> <span class="n">overlay</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">slice_width</span><span class="p">]</span>
            <span class="n">lvl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slice_match_level</span><span class="p">(</span><span class="n">overlay_slice</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">lvl</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="n">lvl</span> <span class="o">&gt;</span> <span class="n">best_lvl</span><span class="p">:</span>
                <span class="n">best_lvl</span> <span class="o">=</span> <span class="n">lvl</span>
                <span class="n">match_slice</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="n">slice_width</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">best_lvl</span><span class="p">,</span> <span class="n">match_slice</span><span class="p">)</span> <span class="k">if</span> <span class="n">best_lvl</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">None</span>

</div>
<div class="viewcode-block" id="Compositor.apply"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Compositor.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">input_ranges</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the compositor on the input with the given input ranges.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.overlay</span> <span class="kn">import</span> <span class="n">CompositeOverlay</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">CompositeOverlay</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">input_ranges</span><span class="o">=</span><span class="n">input_ranges</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">input_ranges</span><span class="o">=</span><span class="n">input_ranges</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">process_element</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>


</div></div>
<div class="viewcode-block" id="Store"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Store">[docs]</a><span class="k">class</span> <span class="nc">Store</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Store is what links up HoloViews objects to their</span>
<span class="sd">    corresponding options and to the appropriate classes of the chosen</span>
<span class="sd">    backend (e.g for rendering).</span>

<span class="sd">    In addition, Store supports pickle operations that automatically</span>
<span class="sd">    pickle and unpickle the corresponding options for a HoloViews</span>
<span class="sd">    object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">renderers</span> <span class="o">=</span> <span class="p">{}</span> <span class="c"># The set of available Renderers across all backends.</span>

    <span class="c"># A mapping from ViewableElement types to their corresponding plot</span>
    <span class="c"># types grouped by the backend. Set using the register method.</span>
    <span class="n">registry</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c"># Once register_plotting_classes is called, this OptionTree is</span>
    <span class="c"># populated for the given backend.</span>
    <span class="n">_options</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c"># A list of hooks to call after registering the plot and style options</span>
    <span class="n">option_setters</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c"># A dictionary of custom OptionTree by custom object id by backend</span>
    <span class="n">_custom_options</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;matplotlib&#39;</span><span class="p">:{}}</span>
    <span class="n">load_counter_offset</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">save_option_state</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="n">current_backend</span> <span class="o">=</span> <span class="s">&#39;matplotlib&#39;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">backend</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">current_backend</span> <span class="k">if</span> <span class="n">backend</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">backend</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="n">backend</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="n">backend</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">custom_options</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">backend</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">current_backend</span> <span class="k">if</span> <span class="n">backend</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">backend</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_custom_options</span><span class="p">[</span><span class="n">backend</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">_custom_options</span><span class="p">[</span><span class="n">backend</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Store.load"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Store.load">[docs]</a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to pickle.load except that the HoloViews trees is</span>
<span class="sd">        restored appropriately.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">load_counter_offset</span> <span class="o">=</span> <span class="n">StoreOptions</span><span class="o">.</span><span class="n">id_offset</span><span class="p">()</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">load_counter_offset</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">val</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Store.loads"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Store.loads">[docs]</a>    <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">pickle_string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to pickle.loads except that the HoloViews trees is</span>
<span class="sd">        restored appropriately.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">load_counter_offset</span> <span class="o">=</span> <span class="n">StoreOptions</span><span class="o">.</span><span class="n">id_offset</span><span class="p">()</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle_string</span><span class="p">)</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">load_counter_offset</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">val</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Store.dump"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Store.dump">[docs]</a>    <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to pickle.dump except that the HoloViews option</span>
<span class="sd">        tree is saved appropriately.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">save_option_state</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">protocol</span><span class="p">)</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">save_option_state</span> <span class="o">=</span> <span class="bp">False</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Store.dumps"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Store.dumps">[docs]</a>    <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to pickle.dumps except that the HoloViews option</span>
<span class="sd">        tree is saved appropriately.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">save_option_state</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">protocol</span><span class="p">)</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">save_option_state</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="n">val</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Store.info"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Store.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">ansi</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s">&#39;matplotlib&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show information about a particular object or component class</span>
<span class="sd">        including the applicable style and plot options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="n">InfoPrinter</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ansi</span><span class="o">=</span><span class="n">ansi</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">))</span>

</div>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">lookup_options</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">group</span><span class="p">):</span>
        <span class="c"># Current custom_options dict may not have entry for obj.id</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">_custom_options</span><span class="p">[</span><span class="n">backend</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_custom_options</span><span class="p">[</span><span class="n">backend</span><span class="p">][</span><span class="n">obj</span><span class="o">.</span><span class="n">id</span><span class="p">]</span><span class="o">.</span><span class="n">closest</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="n">backend</span><span class="p">]</span><span class="o">.</span><span class="n">closest</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Store.lookup"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Store.lookup">[docs]</a>    <span class="k">def</span> <span class="nf">lookup</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given an object, lookup the corresponding customized option</span>
<span class="sd">        tree if a single custom tree is applicable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">el</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="k">if</span> <span class="n">el</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Object does not own a custom options tree&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">idlist</span> <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ids</span><span class="p">)])</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Object contains elements combined across &quot;</span>
                            <span class="s">&quot;multiple custom trees (ids </span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">idlist</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_custom_options</span><span class="p">[</span><span class="n">backend</span><span class="p">][</span><span class="nb">list</span><span class="p">(</span><span class="n">ids</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Store.add_style_opts"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Store.add_style_opts">[docs]</a>    <span class="k">def</span> <span class="nf">add_style_opts</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="n">new_options</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a component such as an Element (e.g. Image, Curve) or a</span>
<span class="sd">        container (e.g Layout) specify new style options to be</span>
<span class="sd">        accepted by the corresponding plotting class.</span>

<span class="sd">        Note: This is supplied for advanced users who know which</span>
<span class="sd">        additional style keywords are appropriate for the</span>
<span class="sd">        corresponding plotting class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">backend</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">current_backend</span> <span class="k">if</span> <span class="n">backend</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">backend</span>
        <span class="k">if</span> <span class="n">component</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="n">backend</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Component </span><span class="si">%r</span><span class="s"> not registered to a plotting class&quot;</span> <span class="o">%</span> <span class="n">component</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_options</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">new_options</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Please supply a list of style option keyword strings&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">param</span><span class="o">.</span><span class="n">logging_level</span><span class="p">(</span><span class="s">&#39;CRITICAL&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">new_options</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">option</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="n">backend</span><span class="p">][</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">style_opts</span><span class="p">:</span>
                    <span class="n">plot_class</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="n">backend</span><span class="p">][</span><span class="n">component</span><span class="p">]</span>
                    <span class="n">plot_class</span><span class="o">.</span><span class="n">style_opts</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">plot_class</span><span class="o">.</span><span class="n">style_opts</span><span class="o">+</span><span class="p">[</span><span class="n">option</span><span class="p">])</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="n">backend</span><span class="p">][</span><span class="nb">type</span><span class="p">(</span><span class="n">component</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">(</span><span class="s">&#39;style&#39;</span><span class="p">,</span> <span class="n">merge_keywords</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">allowed_keywords</span><span class="o">=</span><span class="n">new_options</span><span class="p">)</span>

</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Store.register"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.Store.register">[docs]</a>    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">associations</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">style_aliases</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register the supplied dictionary of associations between</span>
<span class="sd">        elements and plotting classes to the specified backend.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.overlay</span> <span class="kn">import</span> <span class="n">CompositeOverlay</span>
        <span class="k">if</span> <span class="n">backend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">registry</span><span class="p">:</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="n">backend</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="n">backend</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">associations</span><span class="p">)</span>

        <span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;style&#39;</span><span class="p">,</span> <span class="s">&#39;plot&#39;</span><span class="p">,</span> <span class="s">&#39;norm&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">backend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">_options</span><span class="p">:</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="n">backend</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionTree</span><span class="p">([],</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">backend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">_custom_options</span><span class="p">:</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">_custom_options</span><span class="p">[</span><span class="n">backend</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">view_class</span><span class="p">,</span> <span class="n">plot</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="n">backend</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">expanded_opts</span> <span class="o">=</span> <span class="p">[</span><span class="n">opt</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">plot</span><span class="o">.</span><span class="n">style_opts</span>
                             <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">style_aliases</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[])]</span>
            <span class="n">style_opts</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">expanded_opts</span> <span class="o">+</span> <span class="n">plot</span><span class="o">.</span><span class="n">style_opts</span><span class="p">))</span>
            <span class="n">plot_opts</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">plot</span><span class="o">.</span><span class="n">params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]]</span>

            <span class="k">with</span> <span class="n">param</span><span class="o">.</span><span class="n">logging_level</span><span class="p">(</span><span class="s">&#39;CRITICAL&#39;</span><span class="p">):</span>
                <span class="n">plot</span><span class="o">.</span><span class="n">style_opts</span> <span class="o">=</span> <span class="n">style_opts</span>

            <span class="n">opt_groups</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;plot&#39;</span><span class="p">:</span> <span class="n">Options</span><span class="p">(</span><span class="n">allowed_keywords</span><span class="o">=</span><span class="n">plot_opts</span><span class="p">)}</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">view_class</span><span class="p">,</span> <span class="n">CompositeOverlay</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s">&#39;style_opts&#39;</span><span class="p">):</span>
                 <span class="n">opt_groups</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&#39;style&#39;</span><span class="p">:</span> <span class="n">Options</span><span class="p">(</span><span class="n">allowed_keywords</span><span class="o">=</span><span class="n">style_opts</span><span class="p">),</span>
                                    <span class="s">&#39;norm&#39;</span><span class="p">:</span>  <span class="n">Options</span><span class="p">(</span><span class="n">framewise</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">axiswise</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                                     <span class="n">allowed_keywords</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;framewise&#39;</span><span class="p">,</span>
                                                                       <span class="s">&#39;axiswise&#39;</span><span class="p">])})</span>

            <span class="n">name</span> <span class="o">=</span> <span class="n">view_class</span><span class="o">.</span><span class="n">__name__</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">_options</span><span class="p">[</span><span class="n">backend</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">opt_groups</span>


</div></div>
<div class="viewcode-block" id="StoreOptions"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.StoreOptions">[docs]</a><span class="k">class</span> <span class="nc">StoreOptions</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A collection of utilities for advanced users for creating and</span>
<span class="sd">    setting customized option tress on the Store. Designed for use by</span>
<span class="sd">    either advanced users or the %opts line and cell magics which use</span>
<span class="sd">    this machinery.</span>

<span class="sd">    This class also holds general classmethods for working with</span>
<span class="sd">    OptionTree instances: as OptionTrees are designed for attribute</span>
<span class="sd">    access it is best to minimize the number of methods implemented on</span>
<span class="sd">    that class and implement the necessary utilities on StoreOptions</span>
<span class="sd">    instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#===============#</span>
    <span class="c"># ID management #</span>
    <span class="c">#===============#</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_object_ids</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">el</span> <span class="k">for</span> <span class="n">el</span>
                   <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)))</span>


    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="StoreOptions.propagate_ids"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.StoreOptions.propagate_ids">[docs]</a>    <span class="k">def</span> <span class="nf">propagate_ids</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">match_id</span><span class="p">,</span> <span class="n">new_id</span><span class="p">,</span> <span class="n">applied_keys</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursively propagate an id through an object for components</span>
<span class="sd">        matching the applied_keys. This method can only be called if</span>
<span class="sd">        there is a tree with a matching id in Store.custom_options</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_id</span> <span class="ow">in</span> <span class="n">Store</span><span class="o">.</span><span class="n">custom_options</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s">&quot;The set_ids method requires &quot;</span>
                                 <span class="s">&quot;Store.custom_options to contain&quot;</span>
                                 <span class="s">&quot; a tree with id </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">new_id</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="n">new_id</span><span class="p">)</span>
                      <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">match_id</span> <span class="k">else</span> <span class="bp">None</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">applied_keys</span><span class="p">))</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="StoreOptions.capture_ids"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.StoreOptions.capture_ids">[docs]</a>    <span class="k">def</span> <span class="nf">capture_ids</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given an list of ids, capture a list of ids that can be</span>
<span class="sd">        restored using the restore_ids.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="s">&#39;id&#39;</span><span class="p">))</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="StoreOptions.restore_ids"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.StoreOptions.restore_ids">[docs]</a>    <span class="k">def</span> <span class="nf">restore_ids</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">ids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given an list of ids as captured with capture_ids, restore the</span>
<span class="sd">        ids. Note the structure of an object must not change between</span>
<span class="sd">        the calls to capture_ids and restore_ids.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="nb">next</span><span class="p">(</span><span class="n">ids</span><span class="p">)))</span>

</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="StoreOptions.apply_customizations"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.StoreOptions.apply_customizations">[docs]</a>    <span class="k">def</span> <span class="nf">apply_customizations</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the given option specs to the supplied options tree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="n">customization</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="o">.</span><span class="n">key</span><span class="p">:</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">[</span><span class="n">key</span><span class="p">]}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">customization</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:(</span><span class="n">Options</span><span class="p">(</span><span class="o">**</span><span class="n">v</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span><span class="p">)</span>
                                 <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="n">options</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="n">customization</span>
        <span class="k">return</span> <span class="n">options</span>

</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="StoreOptions.validate_spec"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.StoreOptions.validate_spec">[docs]</a>    <span class="k">def</span> <span class="nf">validate_spec</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="n">Options</span><span class="o">.</span><span class="n">skip_invalid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a specification, validated it against the default</span>
<span class="sd">        options tree (Store.options). Only tends to be useful when</span>
<span class="sd">        invalid keywords generate exceptions instead of skipping.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">skip</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">OptionTree</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="n">Store</span><span class="o">.</span><span class="n">options</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
                             <span class="n">groups</span><span class="o">=</span><span class="n">Store</span><span class="o">.</span><span class="n">options</span><span class="p">()</span><span class="o">.</span><span class="n">groups</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">apply_customizations</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="StoreOptions.expand_compositor_keys"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.StoreOptions.expand_compositor_keys">[docs]</a>    <span class="k">def</span> <span class="nf">expand_compositor_keys</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">spec</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Expands compositor definition keys into {type}.{group}</span>
<span class="sd">        keys. For instance a compositor operation returning a group</span>
<span class="sd">        string &#39;Image&#39; of element type RGB expands to &#39;RGB.Image&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">expanded_spec</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">applied_keys</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">compositor_defs</span> <span class="o">=</span> <span class="p">{</span><span class="n">el</span><span class="o">.</span><span class="n">group</span><span class="p">:</span><span class="n">el</span><span class="o">.</span><span class="n">output_type</span><span class="o">.</span><span class="n">__name__</span>
                           <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">Compositor</span><span class="o">.</span><span class="n">definitions</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">spec</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">compositor_defs</span><span class="p">:</span>
                <span class="n">expanded_spec</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># Send id to Overlays</span>
                <span class="n">applied_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Overlay&#39;</span><span class="p">]</span>
                <span class="n">type_name</span> <span class="o">=</span> <span class="n">compositor_defs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">expanded_spec</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">type_name</span><span class="o">+</span><span class="s">&#39;.&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">expanded_spec</span><span class="p">,</span> <span class="n">applied_keys</span>

</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="StoreOptions.create_custom_trees"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.StoreOptions.create_custom_trees">[docs]</a>    <span class="k">def</span> <span class="nf">create_custom_trees</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the appropriate set of customized subtree clones for</span>
<span class="sd">        an object, suitable for merging with Store.custom_options (i.e</span>
<span class="sd">        with the ids appropriately offset). Note if an object has no</span>
<span class="sd">        integer ids a new OptionTree is built.</span>

<span class="sd">        The id_mapping return value is a list mapping the ids that</span>
<span class="sd">        need to be matched as set to their new values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clones</span><span class="p">,</span> <span class="n">id_mapping</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">[]</span>
        <span class="n">obj_ids</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">get_object_ids</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">id_offset</span><span class="p">()</span>
        <span class="n">obj_ids</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj_ids</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="n">obj_ids</span>
        <span class="k">for</span> <span class="n">tree_id</span> <span class="ow">in</span> <span class="n">obj_ids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tree_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">tree_id</span> <span class="ow">in</span> <span class="n">Store</span><span class="o">.</span><span class="n">custom_options</span><span class="p">():</span>
                <span class="n">original</span> <span class="o">=</span> <span class="n">Store</span><span class="o">.</span><span class="n">custom_options</span><span class="p">()[</span><span class="n">tree_id</span><span class="p">]</span>
                <span class="n">clone</span> <span class="o">=</span> <span class="n">OptionTree</span><span class="p">(</span><span class="n">items</span> <span class="o">=</span> <span class="n">original</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
                                   <span class="n">groups</span> <span class="o">=</span> <span class="n">original</span><span class="o">.</span><span class="n">groups</span><span class="p">)</span>
                <span class="n">clones</span><span class="p">[</span><span class="n">tree_id</span> <span class="o">+</span> <span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">clone</span>
                <span class="n">id_mapping</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tree_id</span><span class="p">,</span> <span class="n">tree_id</span> <span class="o">+</span> <span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">clone</span> <span class="o">=</span> <span class="n">OptionTree</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">Store</span><span class="o">.</span><span class="n">options</span><span class="p">()</span><span class="o">.</span><span class="n">groups</span><span class="p">)</span>
                <span class="n">clones</span><span class="p">[</span><span class="n">offset</span><span class="p">]</span> <span class="o">=</span> <span class="n">clone</span>
                <span class="n">id_mapping</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tree_id</span><span class="p">,</span> <span class="n">offset</span><span class="p">))</span>

           <span class="c"># Nodes needed to ensure allowed_keywords is respected</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">Store</span><span class="o">.</span><span class="n">options</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">opt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],)</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">options</span><span class="p">]:</span>
                    <span class="n">group</span> <span class="o">=</span> <span class="p">{</span><span class="n">grp</span><span class="p">:</span><span class="n">Options</span><span class="p">(</span>
                        <span class="n">allowed_keywords</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">allowed_keywords</span><span class="p">)</span>
                             <span class="k">for</span> <span class="p">(</span><span class="n">grp</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span> <span class="ow">in</span>
                             <span class="n">Store</span><span class="o">.</span><span class="n">options</span><span class="p">()[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
                    <span class="n">clone</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span>

        <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">cls</span><span class="o">.</span><span class="n">apply_customizations</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="k">if</span> <span class="n">options</span> <span class="k">else</span> <span class="n">t</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="n">clones</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span> <span class="n">id_mapping</span>

</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="StoreOptions.merge_options"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.StoreOptions.merge_options">[docs]</a>    <span class="k">def</span> <span class="nf">merge_options</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a full options dictionary and options groups specified</span>
<span class="sd">        as a keywords such as return the full set of merged options:</span>

<span class="sd">        &gt;&gt;&gt; options={&#39;Curve&#39;:{&#39;style&#39;:dict(color=&#39;b&#39;)}}</span>
<span class="sd">        &gt;&gt;&gt; style={&#39;Curve&#39;:{&#39;linewidth&#39;:10 }}</span>
<span class="sd">        &gt;&gt;&gt; merged = StoreOptions.merge_options([&#39;style&#39;], options, style=style)</span>
<span class="sd">        &gt;&gt;&gt; sorted(merged[&#39;Curve&#39;][&#39;style&#39;].items())</span>
<span class="sd">        [(&#39;color&#39;, &#39;b&#39;), (&#39;linewidth&#39;, 10)]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">options</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&lt;=</span> <span class="n">groups</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="n">options</span><span class="p">,</span> <span class="bp">None</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">options</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="n">groups</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">options</span><span class="p">)):</span>
              <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;All keys must be a subset of </span><span class="si">%s</span><span class="s">&quot;</span>
                              <span class="o">%</span> <span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">groups</span><span class="p">))</span>

        <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="p">(</span><span class="n">options</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
        <span class="n">all_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">k</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">spec_key</span> <span class="ow">in</span> <span class="n">all_keys</span><span class="p">:</span>
            <span class="n">additions</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">spec_key</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                    <span class="n">kws</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">spec_key</span><span class="p">]</span>
                    <span class="n">additions</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">k</span><span class="p">:</span><span class="n">kws</span><span class="p">})</span>
            <span class="k">if</span> <span class="n">spec_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
                <span class="n">options</span><span class="p">[</span><span class="n">spec_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">additions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="n">spec_key</span><span class="p">]:</span>
                    <span class="n">options</span><span class="p">[</span><span class="n">spec_key</span><span class="p">][</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">additions</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">options</span><span class="p">[</span><span class="n">spec_key</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">additions</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">options</span>

</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="StoreOptions.state"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.StoreOptions.state">[docs]</a>    <span class="k">def</span> <span class="nf">state</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to capture and restore option state. When called</span>
<span class="sd">        without any state supplied, the current state is</span>
<span class="sd">        returned. Then if this state is supplied back in a later call</span>
<span class="sd">        using the same object, the original state is restored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ids</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">capture_ids</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="n">original_custom_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">Store</span><span class="o">.</span><span class="n">custom_options</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">original_custom_keys</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">original_custom_keys</span><span class="p">)</span> <span class="o">=</span> <span class="n">state</span>
            <span class="n">current_custom_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">Store</span><span class="o">.</span><span class="n">custom_options</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">current_custom_keys</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">original_custom_keys</span><span class="p">):</span>
                <span class="k">del</span> <span class="n">Store</span><span class="o">.</span><span class="n">custom_options</span><span class="p">()[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">cls</span><span class="o">.</span><span class="n">restore_ids</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ids</span><span class="p">)</span>
</div>
    <span class="nd">@classmethod</span>
    <span class="nd">@contextmanager</span>
<div class="viewcode-block" id="StoreOptions.options"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.StoreOptions.options">[docs]</a>    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Context-manager for temporarily setting options on an object</span>
<span class="sd">        (if options is None, no options will be set) . Once the</span>
<span class="sd">        context manager exits, both the object and the Store will be</span>
<span class="sd">        left in exactly the same state they were in before the context</span>
<span class="sd">        manager was used.</span>

<span class="sd">        See holoviews.core.options.set_options function for more</span>
<span class="sd">        information on the options specification format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">options</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="n">kwargs</span> <span class="o">==</span> <span class="p">{}:</span> <span class="k">yield</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">optstate</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">state</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="n">groups</span> <span class="o">=</span> <span class="n">Store</span><span class="o">.</span><span class="n">options</span><span class="p">()</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">merge_options</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
            <span class="k">yield</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">state</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">optstate</span><span class="p">)</span>

</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="StoreOptions.id_offset"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.StoreOptions.id_offset">[docs]</a>    <span class="k">def</span> <span class="nf">id_offset</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute an appropriate offset for future id values given the set</span>
<span class="sd">        of ids currently defined across backends.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">max_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">backend</span> <span class="ow">in</span> <span class="n">Store</span><span class="o">.</span><span class="n">renderers</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">store_ids</span> <span class="o">=</span> <span class="n">Store</span><span class="o">.</span><span class="n">custom_options</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="n">max_id</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">store_ids</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">store_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">max_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_ids</span><span class="p">)</span>

</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="StoreOptions.update_backends"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.StoreOptions.update_backends">[docs]</a>    <span class="k">def</span> <span class="nf">update_backends</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_mapping</span><span class="p">,</span> <span class="n">custom_trees</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given the id_mapping from previous ids to new ids and the new</span>
<span class="sd">        custom tree dictionary, update the current backend with the</span>
<span class="sd">        supplied trees and update the keys in the remaining backends to</span>
<span class="sd">        stay linked with the current object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Update the custom option entries for the current backend</span>
        <span class="n">Store</span><span class="o">.</span><span class="n">custom_options</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">custom_trees</span><span class="p">)</span>
        <span class="c"># Update the entries in other backends so the ids match correctly</span>
        <span class="k">for</span> <span class="n">backend</span> <span class="ow">in</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">Store</span><span class="o">.</span><span class="n">renderers</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">Store</span><span class="o">.</span><span class="n">current_backend</span><span class="p">]:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">old_id</span><span class="p">,</span> <span class="n">new_id</span><span class="p">)</span> <span class="ow">in</span> <span class="n">id_mapping</span><span class="p">:</span>
                <span class="n">tree</span> <span class="o">=</span> <span class="n">Store</span><span class="o">.</span><span class="n">_custom_options</span><span class="p">[</span><span class="n">backend</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">old_id</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">Store</span><span class="o">.</span><span class="n">_custom_options</span><span class="p">[</span><span class="n">backend</span><span class="p">][</span><span class="n">new_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span>

</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="StoreOptions.set_options"><a class="viewcode-back" href="../../../Reference_Manual/holoviews.core.html#holoviews.core.options.StoreOptions.set_options">[docs]</a>    <span class="k">def</span> <span class="nf">set_options</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pure Python function for customize HoloViews objects in terms of</span>
<span class="sd">        their style, plot and normalization options.</span>

<span class="sd">        The options specification is a dictionary containing the target</span>
<span class="sd">        for customization as a {type}.{group}.{label} keys. An example of</span>
<span class="sd">        such a key is &#39;Image&#39; which would customize all Image components</span>
<span class="sd">        in the object. The key &#39;Image.Channel&#39; would only customize Images</span>
<span class="sd">        in the object that have the group &#39;Channel&#39;.</span>

<span class="sd">        The corresponding value is then a list of Option objects specified</span>
<span class="sd">        with an appropriate category (&#39;plot&#39;, &#39;style&#39; or &#39;norm&#39;). For</span>
<span class="sd">        instance, using the keys described above, the specs could be:</span>

<span class="sd">        {&#39;Image:[Options(&#39;style&#39;, cmap=&#39;jet&#39;)]}</span>

<span class="sd">        Or setting two types of option at once:</span>

<span class="sd">        {&#39;Image.Channel&#39;:[Options(&#39;plot&#39;, size=50),</span>
<span class="sd">                          Options(&#39;style&#39;, cmap=&#39;Blues&#39;)]}</span>


<span class="sd">        Relationship to the %%opts magic</span>
<span class="sd">        ----------------------------------</span>

<span class="sd">        This function matches the functionality supplied by the %%opts</span>
<span class="sd">        cell magic in the IPython extension. In fact, you can use the same</span>
<span class="sd">        syntax as the IPython cell magic to achieve the same customization</span>
<span class="sd">        as shown above:</span>

<span class="sd">        from holoviews.ipython.parser import OptsSpec</span>
<span class="sd">        set_options(my_image, OptsSpec.parse(&quot;Image (cmap=&#39;jet&#39;)&quot;))</span>

<span class="sd">        Then setting both plot and style options:</span>

<span class="sd">        set_options(my_image, OptsSpec.parse(&quot;Image [size=50] (cmap=&#39;Blues&#39;)&quot;))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Note that an alternate, more verbose and less recommended</span>
        <span class="c"># syntax can also be used:</span>

        <span class="c"># {&#39;Image.Channel:{&#39;plot&#39;:  Options(size=50),</span>
        <span class="c">#                  &#39;style&#39;: Options(&#39;style&#39;, cmap=&#39;Blues&#39;)]}</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">merge_options</span><span class="p">(</span><span class="n">Store</span><span class="o">.</span><span class="n">options</span><span class="p">()</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">options</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">spec</span><span class="p">,</span> <span class="n">compositor_applied</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">expand_compositor_keys</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
        <span class="n">custom_trees</span><span class="p">,</span> <span class="n">id_mapping</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">create_custom_trees</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">update_backends</span><span class="p">(</span><span class="n">id_mapping</span><span class="p">,</span> <span class="n">custom_trees</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">tree_id</span><span class="p">,</span> <span class="p">(</span><span class="n">match_id</span><span class="p">,</span> <span class="n">new_id</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">custom_trees</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">id_mapping</span><span class="p">):</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">propagate_ids</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">match_id</span><span class="p">,</span> <span class="n">new_id</span><span class="p">,</span> <span class="n">compositor_applied</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="k">return</span> <span class="n">obj</span></div></div>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015 IOAM: Jean-Luc R. Stevens, Philipp Rudiger, and James A. Bednar.
    </p>
  </div>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61554933-1', 'auto');
  ga('send', 'pageview');

  </script>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.4.0a1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>